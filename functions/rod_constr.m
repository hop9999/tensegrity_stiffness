function [c,ceq] = rod_constr(x,robot)
n = length(robot.d) - length(robot.base)/6;
n_plane_4 = length(robot.planes_4_d)/6;
c = [];
ceq = zeros(1,n + n_plane_4*6);
for i = 1:n
    ceq(i) = (robot.d(i+length(robot.base)/6)^2 - (x((i-1)*6 + 1) - x((i-1)*6 + 4))^2-...
                                                  (x((i-1)*6 + 2) - x((i-1)*6 + 5))^2 -...
                                                  (x((i-1)*6 + 3) - x((i-1)*6 + 6))^2);
end
for i = 1:n_plane_4
    ceq(n+(i-1)*6+1) = (robot.planes_4_d((i-1)*6 + 1)^2 - (x((i-1)*12 + 1 + n*6) - x((i-1)*12 + 4 + n*6))^2-...
                                                  (x((i-1)*12 + 2 + n*6) - x((i-1)*12 + 5 + n*6))^2 -...
                                                  (x((i-1)*12 + 3 + n*6) - x((i-1)*12 + 6 + n*6))^2);
    
    ceq(n+(i-1)*6+2) = (robot.planes_4_d((i-1)*6 + 2)^2 - (x((i-1)*12 + 4 + n*6) - x((i-1)*12 + 7 + n*6))^2-...
                                                  (x((i-1)*12 + 5 + n*6) - x((i-1)*12 + 8 + n*6))^2 -...
                                                  (x((i-1)*12 + 6 + n*6) - x((i-1)*12 + 9 + n*6))^2);
    
    ceq(n+(i-1)*6+3) = (robot.planes_4_d((i-1)*6 + 3)^2 - (x((i-1)*12 + 7 + n*6) - x((i-1)*12 + 10 + n*6))^2-...
                                                  (x((i-1)*12 + 8 + n*6) - x((i-1)*12 + 11 + n*6))^2 -...
                                                  (x((i-1)*12 + 9 + n*6) - x((i-1)*12 + 12 + n*6))^2);
    
    ceq(n+(i-1)*6+4) = (robot.planes_4_d((i-1)*6 + 4)^2 - (x((i-1)*12 + 10 + n*6) - x((i-1)*12 + 1 + n*6))^2-...
                                                  (x((i-1)*12 + 11 + n*6) - x((i-1)*12 + 2 + n*6))^2 -...
                                                  (x((i-1)*12 + 12 + n*6) - x((i-1)*12 + 3 + n*6))^2);
    
    ceq(n+(i-1)*6+5) = (robot.planes_4_d((i-1)*6 + 5)^2 - (x((i-1)*12 + 1 + n*6) - x((i-1)*12 + 7 + n*6))^2-...
                                                  (x((i-1)*12 + 2 + n*6) - x((i-1)*12 + 8 + n*6))^2 -...
                                                  (x((i-1)*12 + 3 + n*6) - x((i-1)*12 + 9 + n*6))^2);
    
    ceq(n+(i-1)*6+6) = (robot.planes_4_d((i-1)*6 + 6)^2 - (x((i-1)*12 + 4 + n*6) - x((i-1)*12 + 10 + n*6))^2-...
                                                  (x((i-1)*12 + 5 + n*6) - x((i-1)*12 + 11 + n*6))^2 -...
                                                  (x((i-1)*12 + 6 + n*6) - x((i-1)*12 + 12 + n*6))^2);
end
end